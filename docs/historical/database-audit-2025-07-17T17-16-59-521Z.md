# DATABASE-SCHEMA AUDIT REPORT
Generated at: 2025-07-17T17:16:59.521Z

✅ Database structure backed up to: database-backup-2025-07-17T17-16-59-521Z.json

## SUMMARY
- Schema tables: 76
- Database tables: 78

## CRITICAL FINDINGS

### 1. Tables Only in Database (might have been rolled back from schema):
- dashboards
  Records: 0

### 2. Tables Only in Schema (need to be created in database):
None

### 3. Orphaned Columns (in DB but not schema - POTENTIALLY VALID!):
These might be columns that were rolled back in schema but are still being used.

#### Table: admin_prompt_reviews
- prompt_id (text)
- reviewer_id (integer)
- review_status (text)
- feedback (text)

#### Table: allergies
- patient_id (integer)
- encounter_id (integer)
- allergen (text)
- reaction (text)
- severity (text)
- onset_date (date)
- notes (text)
- status (text)
- verified_by (integer)
- verified_at (timestamp without time zone)
- source_type (text)
- source_confidence (numeric)
- source_timestamp (timestamp without time zone)
- extracted_from_attachment_id (integer)
- extraction_notes (text)
- allergy_type (text)
- reaction_type (text)
- consolidation_reasoning (text)
- merged_ids (ARRAY)
- visit_history (jsonb)
- last_reaction (date)
- last_reaction_date (date)
- verification_status (text)
- drug_class (text)
- cross_reactivity (ARRAY)
- source_notes (text)
- entered_by (integer)
- temporal_conflict_resolution (text)
- last_updated_encounter (integer)

#### Table: appointment_duration_history
- appointment_id (integer)
- predicted_duration (integer)
- actual_duration (integer)

#### Table: appointment_resource_requirements
- appointment_type_id (integer)
- resource_type (text)
- resource_id (integer)

#### Table: appointment_types
- health_system_id (integer)
  ⚠️  HAS DATA: 4 non-null values
- name (character varying)
  ⚠️  HAS DATA: 4 non-null values
- duration_minutes (integer)
  ⚠️  HAS DATA: 4 non-null values
- color (character varying)
  ⚠️  HAS DATA: 4 non-null values
- description (text)
- is_active (boolean)
  ⚠️  HAS DATA: 4 non-null values

#### Table: appointments
- patient_id (integer)
- provider_id (integer)
- location_id (integer)
- appointment_type_id (integer)
- start_time (timestamp with time zone)
- end_time (timestamp with time zone)
- duration_minutes (integer)
- ai_predicted_duration (integer)
- status (character varying)
- chief_complaint (text)
- notes (text)
- checked_in_at (timestamp with time zone)
- checked_in_by (integer)
- completed_at (timestamp with time zone)
- completed_by (integer)
- cancelled_at (timestamp with time zone)
- cancelled_by (integer)
- cancellation_reason (text)
- duration (integer)
- patient_visible_duration (integer)
- actual_duration (integer)
- use_ai_scheduling (boolean)
- resource_requirements (jsonb)
- tags (ARRAY)
- insurance_verified (boolean)
- insurance_verification_notes (text)
- copay_collected (boolean)
- copay_amount (numeric)
- forms_completed (boolean)
- vital_signs_taken (boolean)
- room_number (text)
- intake_completed_at (timestamp without time zone)
- provider_ready_at (timestamp without time zone)
- visit_completed_at (timestamp without time zone)
- no_show_reason (text)
- late_cancellation_reason (text)
- rescheduled_from (integer)
- rescheduled_reason (text)
- parent_appointment_id (integer)
- recurrence_rule (text)
- recurrence_exceptions (ARRAY)
- reminder_sent (boolean)
- reminder_sent_at (timestamp without time zone)
- confirmation_sent (boolean)
- confirmation_sent_at (timestamp without time zone)
- patient_confirmed (boolean)
- patient_confirmed_at (timestamp without time zone)
- wait_list_priority (integer)
- referring_provider (text)
- referral_reason (text)
- interpreter_needed (boolean)
- interpreter_language (text)
- wheelchair_accessible (boolean)
- special_instructions (text)
- pre_appointment_notes (text)
- post_appointment_notes (text)
- billing_notes (text)
- chart_reviewed (boolean)
- labs_reviewed (boolean)
- images_reviewed (boolean)
- medications_reconciled (boolean)
- problems_reviewed (boolean)

#### Table: article_comments
- article_id (integer)
- author_name (text)
- author_email (text)
- content (text)
- is_approved (boolean)
- parent_id (integer)

#### Table: article_generation_queue
- topic (text)
- category (text)
  ⚠️  HAS DATA: 8 non-null values
- target_audience (text)
  ⚠️  HAS DATA: 8 non-null values
- keywords (ARRAY)
  ⚠️  HAS DATA: 8 non-null values
- competitor_mentions (ARRAY)
  ⚠️  HAS DATA: 8 non-null values
- research_sources (jsonb)
  ⚠️  HAS DATA: 7 non-null values
- status (text)
  ⚠️  HAS DATA: 8 non-null values
- generated_article_id (integer)
  ⚠️  HAS DATA: 2 non-null values
- error (text)
- processed_at (timestamp without time zone)
  ⚠️  HAS DATA: 7 non-null values
- custom_prompt (text)
  ⚠️  HAS DATA: 2 non-null values

#### Table: article_revisions
- article_id (integer)
  ⚠️  HAS DATA: 1 non-null values
- content (text)
  ⚠️  HAS DATA: 1 non-null values
- revision_note (text)
  ⚠️  HAS DATA: 1 non-null values
- revision_type (text)
  ⚠️  HAS DATA: 1 non-null values
- created_by (integer)
  ⚠️  HAS DATA: 1 non-null values

#### Table: articles
- title (text)
  ⚠️  HAS DATA: 2 non-null values
- slug (text)
  ⚠️  HAS DATA: 2 non-null values
- content (text)
  ⚠️  HAS DATA: 2 non-null values
- excerpt (text)
  ⚠️  HAS DATA: 2 non-null values
- category (text)
  ⚠️  HAS DATA: 2 non-null values
- status (text)
  ⚠️  HAS DATA: 2 non-null values
- author_name (text)
  ⚠️  HAS DATA: 2 non-null values
- featured_image (text)
- meta_title (text)
  ⚠️  HAS DATA: 2 non-null values
- meta_description (text)
  ⚠️  HAS DATA: 2 non-null values
- keywords (ARRAY)
  ⚠️  HAS DATA: 2 non-null values
- target_audience (text)
  ⚠️  HAS DATA: 2 non-null values
- reading_time (integer)
  ⚠️  HAS DATA: 2 non-null values
- view_count (integer)
  ⚠️  HAS DATA: 2 non-null values
- published_at (timestamp without time zone)
  ⚠️  HAS DATA: 2 non-null values
- scheduled_for (timestamp without time zone)
- generated_at (timestamp without time zone)
  ⚠️  HAS DATA: 2 non-null values
- reviewed_at (timestamp without time zone)
  ⚠️  HAS DATA: 2 non-null values
- reviewed_by (integer)
  ⚠️  HAS DATA: 2 non-null values

#### Table: asymmetric_scheduling_config
- provider_id (integer)
- weekday_schedule (jsonb)
- custom_rules (jsonb)
- effective_date (date)

#### Table: attachment_extracted_content
- attachment_id (integer)
- page_number (integer)
- content_type (text)
- extracted_text (text)
- structured_data (jsonb)
- confidence_score (numeric)
- extraction_method (text)
- ai_generated_title (text)
- document_type (text)
- processing_status (text)
- error_message (text)
- processed_at (timestamp without time zone)

#### Table: authentication_logs
- user_id (integer)
- username (character varying)
- event_type (character varying)
- success (boolean)
- ip_address (character varying)
- user_agent (text)
- error_message (text)
- email (text)
- health_system_id (integer)
- failure_reason (text)

#### Table: clinic_admin_verifications
- organization_name (text)
- applicant_first_name (text)
- applicant_last_name (text)
- applicant_email (text)
- applicant_phone (text)
- address_street (text)
- address_city (text)
- address_state (text)
- address_zip (text)
- website (text)
- preferred_ehr_tier (integer)
- verification_status (text)
- verification_score (numeric)
- verification_details (jsonb)
- risk_assessment (jsonb)
- automated_decision (text)
- automated_recommendations (ARRAY)
- manual_review_notes (text)
- reviewer_id (integer)
- reviewed_at (timestamp without time zone)
- api_verification_results (jsonb)

#### Table: data_modification_logs
- user_id (integer)
- table_name (text)
- record_id (integer)
- action (text)
- old_values (jsonb)
- new_values (jsonb)
- reason (text)
- ip_address (text)
- user_agent (text)

#### Table: diagnoses
- patient_id (integer)
- encounter_id (integer)
- diagnosis_code (text)
- diagnosis_description (text)
- diagnosis_type (text)
- status (text)
- onset_date (date)
- resolution_date (date)
- notes (text)
- severity (text)
- clinician_id (integer)
- claim_submission_status (text)
- claim_id (text)
- clearinghouse_id (text)
- payer_id (text)
- allowed_amount (numeric)
- paid_amount (numeric)
- patient_responsibility (numeric)
- adjustment_amount (numeric)
- denial_reason (text)
- denial_code (text)
- appeal_status (text)
- appeal_deadline (text)
- billing_notes (text)
- last_billing_action (text)
- assigned_biller (integer)
- modifier_applied (text)
- billing_action_date (timestamp without time zone)

#### Table: document_processing_queue
- attachment_id (integer)
- status (text)
- priority (integer)
- processor_type (text)
- processing_metadata (jsonb)
- error_message (text)
- retry_count (integer)
- started_at (timestamp without time zone)
- completed_at (timestamp without time zone)

#### Table: email_notifications
- recipient_email (text)
- subject (text)
- body_html (text)
- body_text (text)
- notification_type (text)
- related_user_id (integer)
- related_entity_type (text)
- related_entity_id (integer)
- status (text)
- sent_at (timestamp without time zone)
- error_message (text)
- retry_count (integer)

#### Table: emergency_access_logs
- user_id (integer)
- patient_id (integer)
- access_reason (text)
- emergency_type (text)
- override_restrictions (jsonb)
- supervisor_approval (integer)
- access_duration (integer)
- ip_address (text)

#### Table: encounters
- patient_id (integer)
- provider_id (integer)
- encounter_date (timestamp without time zone)
- encounter_type (character varying)
- visit_reason (text)
- status (character varying)
- location (character varying)
- insurance_verified (boolean)
- copay_collected (numeric)
- notes (text)
- encounter_subtype (text)
- encounter_status (text)
- end_time (timestamp without time zone)
- location_id (integer)
- chief_complaint (text)
- ai_scribe_mode (text)
- ai_suggestions (jsonb)
- signed_by (integer)
- signed_at (timestamp without time zone)
- is_signed (boolean)
- appointment_id (integer)
- start_time (timestamp without time zone)
- note (text)
- nurse_assessment (text)
- nurse_interventions (text)
- nurse_notes (text)
- transcription_id (text)
- assistant_thread_id (text)
- voice_recording_url (text)
- alerts (jsonb)
- transcription_raw (text)
- transcription_processed (text)
- draft_orders (jsonb)
- draft_diagnoses (jsonb)
- cpt_codes (jsonb)
- signature_id (character varying)
- last_chart_update (timestamp without time zone)
- chart_update_duration (integer)
- discharge_summary (text)
- referral_source (text)
- estimated_copay (numeric)
- billing_status (text)
- claim_number (text)
- primary_diagnosis_code (text)
- reimbursement_amount (numeric)
- template_id (integer)

#### Table: external_labs
- patient_id (integer)
- lab_name (text)
- test_name (text)
- test_date (date)
- result_value (text)
- unit (text)
- reference_range (text)
- abnormal_flag (text)
- ordering_provider (text)
- status (text)
- attachment_id (integer)

#### Table: family_history
- patient_id (integer)
- relationship (text)
- condition (text)
- age_at_onset (integer)
- age_at_death (integer)
- cause_of_death (text)
- notes (text)
- source_type (text)
- source_confidence (numeric)
- extracted_from_attachment_id (integer)
- extraction_notes (text)
- maternal_side (boolean)
- living_status (text)
- genetic_marker (text)
- consolidation_reasoning (text)
- merged_ids (ARRAY)
- visit_history (jsonb)

#### Table: gpt_lab_review_notes
- patient_id (integer)
- lab_order_id (integer)
- review_type (text)
- ai_interpretation (text)
- clinical_significance (text)
- follow_up_recommendations (text)
- risk_assessment (jsonb)
- reviewed_by (integer)
- review_status (text)

#### Table: health_systems
- name (character varying)
  ⚠️  HAS DATA: 5 non-null values
- type (character varying)
  ⚠️  HAS DATA: 1 non-null values
- subscription_tier (integer)
  ⚠️  HAS DATA: 5 non-null values
- subscription_status (character varying)
  ⚠️  HAS DATA: 5 non-null values
- subscription_key (character varying)
- is_migration (boolean)
  ⚠️  HAS DATA: 5 non-null values
- stripe_customer_id (character varying)
- metadata (jsonb)
  ⚠️  HAS DATA: 5 non-null values
- short_name (text)
- system_type (text)
  ⚠️  HAS DATA: 5 non-null values
- subscription_start_date (timestamp without time zone)
- subscription_end_date (timestamp without time zone)
- merged_into_health_system_id (integer)
- merged_date (timestamp without time zone)
- original_provider_id (integer)
- primary_contact (text)
- phone (text)
- email (text)
- website (text)
- npi (text)
- tax_id (text)
- logo_url (text)
- brand_colors (jsonb)
- subscription_limits (jsonb)
  ⚠️  HAS DATA: 5 non-null values
- active_user_count (jsonb)
  ⚠️  HAS DATA: 5 non-null values
- billing_details (jsonb)
  ⚠️  HAS DATA: 5 non-null values
- active (boolean)
  ⚠️  HAS DATA: 5 non-null values
- status (text)
  ⚠️  HAS DATA: 5 non-null values

#### Table: imaging_orders
- patient_id (integer)
- encounter_id (integer)
- provider_id (integer)
- imaging_type (text)
- body_part (text)
- laterality (text)
- indication (text)
- clinical_history (text)
- priority (text)
- status (text)
- facility_id (integer)
- scheduled_date (timestamp without time zone)
- completed_date (timestamp without time zone)

#### Table: imaging_results
- patient_id (integer)
- encounter_id (integer)
- imaging_order_id (integer)
- study_type (text)
- body_part (text)
- modality (text)
- study_date (timestamp without time zone)
- accession_number (text)
- performing_facility (text)
- ordering_provider_id (integer)
- reading_radiologist (text)
- findings (text)
- impression (text)
- recommendations (text)
- comparison_studies (text)
- technique (text)
- contrast_used (boolean)
- contrast_type (text)
- radiation_dose (text)
- number_of_images (integer)
- critical_findings (boolean)
- critical_findings_communicated_at (timestamp without time zone)
- report_status (text)
- report_finalized_at (timestamp without time zone)
- addendum (text)
- addendum_date (timestamp without time zone)
- procedure_code (text)
- diagnostic_quality (text)
- limitations (text)
- follow_up_needed (boolean)
- follow_up_timeframe (text)
- bi_rads_score (text)
- lung_rads_score (text)
- ti_rads_score (text)
- pi_rads_score (text)
- liver_rads_score (text)
- incidental_findings (text)
- relevant_history (text)
- clinical_indication (text)
- protocol_name (text)
- series_count (integer)
- image_count (integer)
- study_size_mb (numeric)
- pacs_study_uid (text)
- dicom_retrieval_url (text)
- external_system_id (text)
- source_type (text)
- source_confidence (numeric)
- extracted_from_attachment_id (integer)
- extraction_notes (text)
- consolidation_reasoning (text)
- merged_ids (ARRAY)
- visit_history (jsonb)

#### Table: lab_orders
- order_id (integer)
- external_order_id (text)
- transmitted_at (timestamp without time zone)
- acknowledged_at (timestamp without time zone)
- result_received_at (timestamp without time zone)
- status (text)
- transmission_response (jsonb)
- result_data (jsonb)
- patient_id (integer)
- encounter_id (integer)
- order_set_id (text)
- loinc_code (text)
- provider_id (integer)
- test_name (text)
- cpt_code (text)
- test_code (text)
- test_category (text)
- priority (text)
- clinical_indication (text)
- icd10_codes (ARRAY)
- ordered_by (integer)
- ordered_at (timestamp without time zone)
- target_lab_id (text)
- hl7_message_id (text)
- requisition_number (text)
- order_status (text)
- collected_at (timestamp without time zone)
- specimen_type (text)
- specimen_volume (text)
- specimen_source (text)
- fasting_required (boolean)
- special_instructions (text)
- container_type (text)
- collection_site (text)
- collected_by (integer)
- external_lab (text)
- result_status (text)
- collection_instructions (text)
- reference_range (text)
- expected_turnaround (text)
- external_status (text)
- results (jsonb)
- abnormal_flags (ARRAY)
- fasting_hours (integer)
- discontinued_at (timestamp without time zone)
- discontinued_by (integer)
- discontinued_reason (text)
- critical_values (ARRAY)
- stat_order (boolean)
- timing_instructions (text)
- provider_notes (text)
- patient_preparation (text)
- collection_priority (text)
- processing_notes (text)
- billing_code (text)
- insurance_preauth (text)
- insurance_preauth_date (timestamp without time zone)
- estimated_cost (numeric)
- actual_cost (numeric)
- patient_consent (boolean)
- consent_date (timestamp without time zone)
- insurance_coverage (text)
- patient_copay (numeric)
- billing_status (text)
- billing_date (timestamp without time zone)
- cancellation_reason (text)
- result_interpretation (text)
- ai_suggested_tests (ARRAY)
- ai_analysis (text)
- result_notification_sent (boolean)
- result_notification_date (timestamp without time zone)
- performing_lab_id (integer)
- lab_account_number (text)
- risk_flags (ARRAY)
- quality_control_status (text)
- quality_control_notes (text)
- repeat_test_reason (text)
- original_order_id (integer)
- test_methodology (text)
- quality_measure (text)
- processing_lab_name (text)
- processing_lab_director (text)
- test_validation_status (text)
- regulatory_compliance (text)
- sample_rejection_reason (text)
- preventive_care_flag (boolean)
- clinical_trial_id (text)
- research_study_id (text)
- patient_location (text)
- ordering_facility_id (integer)
- test_performed_at (text)

#### Table: lab_reference_ranges
- test_code (text)
- test_name (text)
- age_min (integer)
- age_max (integer)
- gender (text)
- reference_low (numeric)
- reference_high (numeric)
- critical_low (numeric)
- critical_high (numeric)
- unit (text)
- notes (text)

#### Table: lab_results
- lab_order_id (integer)
- patient_id (integer)
- loinc_code (text)
- test_code (text)
- test_name (text)
- test_category (text)
- result_value (text)
- result_numeric (numeric)
- result_units (text)
- reference_range (text)
- age_gender_adjusted_range (text)
- abnormal_flag (text)
- critical_flag (boolean)
- delta_flag (text)
- specimen_collected_at (timestamp without time zone)
- specimen_received_at (timestamp without time zone)
- result_available_at (timestamp without time zone)
- result_finalized_at (timestamp without time zone)
- received_at (timestamp without time zone)
- external_lab_id (integer)
- external_result_id (text)
- hl7_message_id (text)
- instrument_id (text)
- result_status (text)
- verification_status (text)
- result_comments (text)
- reviewed_by (integer)
- reviewed_at (timestamp without time zone)
- provider_notes (text)
- needs_review (boolean)
- review_status (text)
- review_note (text)
- review_template (text)
- review_history (jsonb)
- patient_communication_sent (boolean)
- patient_communication_method (text)
- patient_communication_sent_at (timestamp without time zone)
- patient_notified_by (integer)
- patient_message (text)
- patient_message_sent_at (timestamp without time zone)
- source_type (text)
- source_confidence (text)
- extracted_from_attachment_id (integer)
- extraction_notes (text)
- consolidation_reasoning (text)
- merged_ids (ARRAY)
- visit_history (jsonb)

#### Table: locations
- name (character varying)
  ⚠️  HAS DATA: 1 non-null values
- address (character varying)
  ⚠️  HAS DATA: 1 non-null values
- city (character varying)
  ⚠️  HAS DATA: 1 non-null values
- state (character varying)
  ⚠️  HAS DATA: 1 non-null values
- zip (character varying)
  ⚠️  HAS DATA: 1 non-null values
- phone (character varying)
- health_system_id (integer)
  ⚠️  HAS DATA: 1 non-null values
- zip_code (text)
- npi (text)
- location_type (text)
- organization_id (integer)
- short_name (text)
- services (jsonb)
  ⚠️  HAS DATA: 1 non-null values
- facility_code (text)
- has_lab (boolean)
  ⚠️  HAS DATA: 1 non-null values
- has_imaging (boolean)
  ⚠️  HAS DATA: 1 non-null values
- has_pharmacy (boolean)
  ⚠️  HAS DATA: 1 non-null values

#### Table: magic_links
- email (text)
- token (text)
- expires_at (timestamp without time zone)
- used (boolean)
- used_at (timestamp without time zone)
- ip_address (text)
- user_agent (text)

#### Table: medical_history
- patient_id (integer)
- condition (text)
- onset_date (date)
- resolution_date (date)
- status (text)
- severity (text)
- notes (text)

#### Table: medical_problems
- patient_id (integer)
- encounter_id (integer)
- problem_title (text)
- icd10_code (text)
- snomed_code (text)
- problem_status (text)
- onset_date (date)
- resolution_date (date)
- notes (text)
- severity (text)
- source_type (text)
- source_confidence (numeric)
- extracted_from_attachment_id (integer)
- extraction_notes (text)
- provider_id (integer)
- date_diagnosed (date)
- last_updated (timestamp without time zone)
- verification_status (text)
- verification_date (timestamp without time zone)
- verified_by (integer)
- clinical_status (text)
- body_site (text)
- body_site_laterality (text)
- category (text)
- current_icd10_code (text)
- last_reviewed_date (timestamp without time zone)
- reviewed_by (integer)
- patient_education_provided (boolean)
- care_plan_status (text)
- functional_impact (text)
- prognosis (text)
- risk_factors (ARRAY)
- associated_conditions (ARRAY)
- treatment_goals (text)
- monitoring_parameters (text)
- follow_up_required (boolean)
- follow_up_date (date)
- problem_ranking (integer)
- display_in_summary (boolean)
- patient_aware (boolean)
- caregiver_aware (boolean)
- reportable_condition (boolean)
- reported_date (date)
- clinical_priority (text)
- social_determinants (jsonb)
- cultural_considerations (text)
- patient_goals (text)
- barriers_to_care (text)
- quality_measures (jsonb)
- outcome_measures (jsonb)
- care_team_members (jsonb)
- care_coordination_notes (text)
- original_problem_text (text)
- mapped_by_ai (boolean)
- ai_confidence_score (numeric)
- human_verified (boolean)
- consolidation_reasoning (text)
- merged_ids (ARRAY)
- visit_history (jsonb)

#### Table: medication_formulary
- medication_name (text)
- generic_name (text)
- drug_class (text)
- dosage_forms (ARRAY)
- strengths (ARRAY)
- route (ARRAY)
- tier (integer)
- prior_auth_required (boolean)
- quantity_limits (jsonb)
- step_therapy (jsonb)
- alternatives (ARRAY)
- active (boolean)

#### Table: medications
- patient_id (integer)
- encounter_id (integer)
- medication_name (text)
- generic_name (text)
- brand_name (text)
- dosage (text)
- strength (text)
- form (text)
- route (text)
- frequency (text)
- sig (text)
- start_date (date)
- end_date (date)
- discontinuation_date (date)
- discontinuation_reason (text)
- status (text)
- prescribed_by (integer)
- prescribed_date (timestamp without time zone)
- pharmacy (text)
- prescriber_notes (text)
- patient_instructions (text)
- ndc_code (text)
- rxnorm_code (text)
- days_supply (integer)
- quantity (integer)
- quantity_unit (text)
- refills (integer)
- refills_remaining (integer)
- lot_number (text)
- expiration_date (date)
- manufacturer (text)
- dea_schedule (text)
- is_controlled (boolean)
- requires_prior_auth (boolean)
- prior_auth_number (text)
- formulary_status (text)
- therapeutic_class (text)
- source_type (text)
- source_confidence (numeric)
- extracted_from_attachment_id (integer)
- extraction_notes (text)
- grouping_strategy (text)
- discontinuation_source (text)
- original_order_id (integer)
- consolidation_reasoning (text)
- merged_ids (ARRAY)
- visit_history (jsonb)
- dosage_form (text)
- total_refills (integer)
- surescripts_id (text)
- clinical_indication (text)
- source_order_id (integer)
- problem_mappings (jsonb)
- reason_for_change (text)
- medication_history (jsonb)
- change_log (jsonb)
- source_notes (text)
- entered_by (integer)
- related_medications (jsonb)
- drug_interactions (jsonb)
- pharmacy_order_id (text)
- insurance_auth_status (text)
- prior_auth_required (boolean)
- discontinued_date (date)
- prescriber (text)
- prescriber_id (integer)
- first_encounter_id (integer)
- last_updated_encounter_id (integer)

#### Table: migration_invitations
- from_health_system_id (integer)
- to_health_system_id (integer)
- invitation_code (text)
- status (text)
- expires_at (timestamp without time zone)

#### Table: newsletter_subscribers
- email (text)
- name (text)
- subscribed_at (timestamp without time zone)
- unsubscribed_at (timestamp without time zone)
- preferences (jsonb)
- source (text)

#### Table: orders
- patient_id (integer)
- encounter_id (integer)
- provider_id (integer)
- order_type (character varying)
- order_date (timestamp without time zone)
- priority (character varying)
- status (character varying)
- medication_name (character varying)
- medication_dosage (character varying)
- medication_route (character varying)
- medication_frequency (character varying)
- medication_duration (character varying)
- medication_quantity (integer)
- medication_refills (integer)
- lab_test_name (character varying)
- lab_test_code (character varying)
- imaging_study_type (character varying)
- imaging_body_part (character varying)
- referral_specialty (character varying)
- referral_reason (text)
- instructions (text)
- clinical_indication (text)
- diagnosis_codes (ARRAY)
- order_status (character varying)
- reference_id (text)
- provider_notes (text)
- dosage (text)
- quantity (integer)
- sig (text)
- refills (integer)
- prescriber (text)
- prescriber_id (integer)
- ordered_by (integer)
- test_name (text)
- test_code (text)
- study_type (text)
- body_part (text)
- lab_name (text)
- ndc_code (text)
- form (text)
- route (text)
- frequency (text)
- duration (text)
- start_date (timestamp without time zone)
- end_date (timestamp without time zone)
- route_of_administration (text)
- indication (text)
- imaging_order_id (integer)
- external_order_id (text)
- days_supply (integer)
- diagnosis_code (text)
- requires_prior_auth (boolean)
- prior_auth_number (text)
- specimen_type (text)
- fasting_required (boolean)
- region (text)
- laterality (text)
- contrast_needed (boolean)
- specialty_type (text)
- provider_name (text)
- urgency (text)
- ordered_at (timestamp without time zone)
- approved_by (integer)
- approved_at (timestamp without time zone)
- quantity_unit (text)

#### Table: organization_documents
- organization_id (integer)
- health_system_id (integer)
- document_type (text)
- document_name (text)
- file_path (text)
- file_size (integer)
- mime_type (text)
- metadata (jsonb)
- uploaded_by (integer)
- active (boolean)

#### Table: organizations
- name (character varying)
- type (character varying)
- address (character varying)
- city (character varying)
- state (character varying)
- zip_code (character varying)
- phone (character varying)
- website (character varying)
- health_system_id (integer)
- short_name (text)
- organization_type (text)
- region (text)
- tax_id (text)
- npi (text)
- email (text)
- active (boolean)

#### Table: patient_attachments
- patient_id (integer)
  ⚠️  HAS DATA: 1 non-null values
- encounter_id (integer)
- filename (text)
- original_filename (text)
- file_type (text)
- file_size (integer)
  ⚠️  HAS DATA: 1 non-null values
- mime_type (text)
  ⚠️  HAS DATA: 1 non-null values
- upload_date (timestamp without time zone)
  ⚠️  HAS DATA: 1 non-null values
- uploaded_by (integer)
  ⚠️  HAS DATA: 1 non-null values
- document_type (text)
- document_date (date)
- description (text)
- thumbnail_path (text)
- ocr_text (text)
- ocr_completed (boolean)
  ⚠️  HAS DATA: 1 non-null values
- ocr_completed_at (timestamp without time zone)
- processing_status (text)
  ⚠️  HAS DATA: 1 non-null values
- processing_notes (text)
- extracted_data (jsonb)
- chart_sections_updated (ARRAY)
- confidence_scores (jsonb)
- hash_value (text)
- is_deleted (boolean)
  ⚠️  HAS DATA: 1 non-null values
- deleted_at (timestamp without time zone)
- deleted_by (integer)
- retention_date (date)
- access_count (integer)
  ⚠️  HAS DATA: 1 non-null values
- last_accessed_at (timestamp without time zone)
- tags (ARRAY)
- source_system (text)
- external_id (text)
- file_name (text)
  ⚠️  HAS DATA: 1 non-null values
- original_file_name (text)
  ⚠️  HAS DATA: 1 non-null values
- file_extension (text)
  ⚠️  HAS DATA: 1 non-null values
- file_path (text)
  ⚠️  HAS DATA: 1 non-null values
- category (text)
  ⚠️  HAS DATA: 1 non-null values
- title (text)
  ⚠️  HAS DATA: 1 non-null values
- is_confidential (boolean)
  ⚠️  HAS DATA: 1 non-null values
- access_level (text)
  ⚠️  HAS DATA: 1 non-null values
- content_hash (text)
  ⚠️  HAS DATA: 1 non-null values
- virus_scan_status (text)
  ⚠️  HAS DATA: 1 non-null values

#### Table: patient_order_preferences
- patient_id (integer)
- provider_id (integer)
- order_type (text)
- preferences (jsonb)
- standing_orders (jsonb)

#### Table: patient_physical_findings
- patient_id (integer)
- encounter_id (integer)
- body_system (text)
- finding (text)
- severity (text)
- laterality (text)
- quality (text)
- duration (text)
- context (text)
- associated_symptoms (text)
- provider_id (integer)
- examined_at (timestamp without time zone)
- is_normal (boolean)
- requires_follow_up (boolean)
- follow_up_timeframe (text)

#### Table: patient_scheduling_patterns
- patient_id (integer)
- provider_id (integer)
- pattern_type (text)
- frequency (jsonb)
- time_preferences (jsonb)
- seasonal_variations (jsonb)

#### Table: patients
- external_id (character varying)
- first_name (character varying)
  ⚠️  HAS DATA: 1 non-null values
- last_name (character varying)
  ⚠️  HAS DATA: 1 non-null values
- middle_name (character varying)
- date_of_birth (date)
  ⚠️  HAS DATA: 1 non-null values
- gender (character varying)
  ⚠️  HAS DATA: 1 non-null values
- email (character varying)
- phone (character varying)
- phone_type (character varying)
- address (character varying)
- city (character varying)
- state (character varying)
- zip (character varying)
- insurance_provider (character varying)
- insurance_policy_number (character varying)
- insurance_group_number (character varying)
- emergency_contact_name (character varying)
- emergency_contact_phone (character varying)
- emergency_contact_relationship (character varying)
- preferred_language (character varying)
  ⚠️  HAS DATA: 1 non-null values
- race (character varying)
- ethnicity (character varying)
- health_system_id (integer)
  ⚠️  HAS DATA: 1 non-null values
- mrn (text)
  ⚠️  HAS DATA: 1 non-null values
- contact_number (text)
- emergency_contact (jsonb)
- preferred_location_id (integer)
- primary_provider_id (integer)
- insurance_primary (text)
- insurance_secondary (text)
- policy_number (text)
- group_number (text)
- assistant_id (text)
- assistant_thread_id (text)
- last_chart_summary (text)
- chart_last_updated (timestamp without time zone)
- active_problems (jsonb)
  ⚠️  HAS DATA: 1 non-null values
- critical_alerts (jsonb)
  ⚠️  HAS DATA: 1 non-null values
- data_origin_type (text)
  ⚠️  HAS DATA: 1 non-null values
- original_facility_id (integer)
  ⚠️  HAS DATA: 1 non-null values
- created_by_provider_id (integer)
  ⚠️  HAS DATA: 1 non-null values
- creation_context (text)
  ⚠️  HAS DATA: 1 non-null values
- derivative_work_note (text)
- migration_consent (jsonb)
  ⚠️  HAS DATA: 1 non-null values
- profile_photo_filename (text)
- consent_given (boolean)
  ⚠️  HAS DATA: 1 non-null values

#### Table: phi_access_logs
- user_id (integer)
  ⚠️  HAS DATA: 1044 non-null values
- patient_id (integer)
  ⚠️  HAS DATA: 523 non-null values
- action (text)
  ⚠️  HAS DATA: 1044 non-null values
- resource_type (text)
  ⚠️  HAS DATA: 1044 non-null values
- resource_id (integer)
  ⚠️  HAS DATA: 1044 non-null values
- ip_address (text)
  ⚠️  HAS DATA: 1044 non-null values
- user_agent (text)
  ⚠️  HAS DATA: 1044 non-null values
- user_name (text)
  ⚠️  HAS DATA: 1044 non-null values
- user_role (text)
  ⚠️  HAS DATA: 1044 non-null values
- health_system_id (integer)
  ⚠️  HAS DATA: 1044 non-null values
- location_id (integer)
- patient_name (text)
  ⚠️  HAS DATA: 502 non-null values
- access_method (text)
  ⚠️  HAS DATA: 1044 non-null values
- http_method (text)
  ⚠️  HAS DATA: 1044 non-null values
- api_endpoint (text)
  ⚠️  HAS DATA: 1044 non-null values
- session_id (text)
  ⚠️  HAS DATA: 1044 non-null values
- success (boolean)
  ⚠️  HAS DATA: 1044 non-null values
- error_message (text)
  ⚠️  HAS DATA: 72 non-null values
- response_time (integer)
  ⚠️  HAS DATA: 1044 non-null values
- access_reason (text)
  ⚠️  HAS DATA: 1044 non-null values
- emergency_access (boolean)
  ⚠️  HAS DATA: 1044 non-null values
- break_glass_reason (text)
- accessed_at (timestamp without time zone)
  ⚠️  HAS DATA: 1044 non-null values

#### Table: problem_rank_overrides
- user_id (integer)
- patient_id (integer)
- problem_id (integer)
- custom_rank (integer)
- reason (text)

#### Table: provider_schedules
- provider_id (integer)
- location_id (integer)
- day_of_week (text)
- start_time (time without time zone)
- end_time (time without time zone)
- break_start (time without time zone)
- break_end (time without time zone)
- effective_from (date)
- effective_to (date)
- schedule_type (text)
- max_appointments (integer)
- active (boolean)

#### Table: provider_scheduling_patterns
- provider_id (integer)
- pattern_type (text)
- preferences (jsonb)
- constraints (jsonb)
- historical_data (jsonb)

#### Table: realtime_schedule_status
- provider_id (integer)
- date (date)
- time_slot (time without time zone)
- status (text)
- appointment_id (integer)
- buffer_status (text)
- efficiency_score (numeric)

#### Table: resource_bookings
- resource_id (integer)
- appointment_id (integer)
- start_time (timestamp without time zone)
- end_time (timestamp without time zone)
- status (text)

#### Table: schedule_exceptions
- provider_id (integer)
- exception_date (date)
- exception_type (text)
- start_time (time without time zone)
- end_time (time without time zone)
- reason (text)
- affects_scheduling (boolean)

#### Table: schedule_preferences
- provider_id (integer)
- preferred_appointment_duration (integer)
- buffer_time_minutes (integer)
- lunch_start (time without time zone)
- lunch_duration (integer)
- max_daily_appointments (integer)
- max_consecutive_appointments (integer)
- preferred_break_after_n_appointments (integer)
- break_duration_minutes (integer)
- allow_double_booking (boolean)
- allow_overtime (boolean)
- overtime_limit_minutes (integer)

#### Table: scheduling_ai_factors
- category (character varying)
- factor_name (character varying)
- description (text)
- data_type (character varying)
- is_enabled (boolean)
- default_weight (numeric)

#### Table: scheduling_ai_weights
- provider_id (integer)
- location_id (integer)
- health_system_id (integer)
- created_by (integer)
- factor_name (character varying)
- weight (numeric)
- is_active (boolean)
- custom_parameters (jsonb)

#### Table: scheduling_resources
- name (text)
- resource_type (text)
- location_id (integer)
- capacity (integer)
- available_hours (jsonb)
- requires_cleaning (boolean)
- cleaning_duration (integer)
- active (boolean)

#### Table: scheduling_rules
- name (text)
- rule_type (text)
- applies_to (text)
- provider_id (integer)
- location_id (integer)
- conditions (jsonb)
- actions (jsonb)
- priority (integer)
- active (boolean)

#### Table: scheduling_templates
- name (text)
- provider_id (integer)
- template_type (text)
- day_configuration (jsonb)
- appointment_types (jsonb)
- buffer_rules (jsonb)
- break_configuration (jsonb)
- active (boolean)

#### Table: signatures
- encounter_id (integer)
- signed_by (integer)
- signature_type (text)
- signed_at (timestamp without time zone)
- signature_data (text)
- ip_address (text)
- attestation_text (text)

#### Table: signed_orders
- order_id (integer)
- patient_id (integer)
- encounter_id (integer)
- order_type (character varying)
- delivery_method (character varying)
- delivery_status (character varying)
- delivery_attempts (integer)
- last_delivery_attempt (timestamp without time zone)
- delivery_error (text)
- can_change_delivery (boolean)
- delivery_lock_reason (character varying)
- original_delivery_method (character varying)
- delivery_changes (jsonb)
- signed_at (timestamp without time zone)
- signed_by (integer)

#### Table: social_history
- patient_id (integer)
- category (text)
- details (text)
- status (text)
- start_date (date)
- end_date (date)
- quantity (text)
- frequency (text)
- notes (text)
- source_type (text)
- source_confidence (numeric)
- extracted_from_attachment_id (integer)
- extraction_notes (text)
- risk_level (text)
- counseling_provided (boolean)
- consolidation_reasoning (text)
- merged_ids (ARRAY)
- visit_history (jsonb)

#### Table: subscription_history
- health_system_id (integer)
- change_type (text)
- previous_tier (integer)
- new_tier (integer)
- previous_status (text)
- new_status (text)
- changed_by (integer)
- reason (text)
- billing_impact (jsonb)
- effective_date (timestamp without time zone)

#### Table: subscription_keys
- health_system_id (integer)
- key_value (text)
- key_type (text)
- created_by (integer)
- assigned_to (integer)
- assigned_at (timestamp without time zone)
- expires_at (timestamp without time zone)
- status (text)
- usage_count (integer)
- last_used_at (timestamp without time zone)
- metadata (jsonb)

#### Table: surgical_history
- patient_id (integer)
- procedure_name (text)
- procedure_date (date)
- surgeon (text)
- facility (text)
- indication (text)
- findings (text)
- complications (text)
- anesthesia_type (text)
- implants_used (text)
- pathology_results (text)
- recovery_notes (text)
- source_type (text)
- source_confidence (numeric)
- extracted_from_attachment_id (integer)
- extraction_notes (text)
- procedure_code (text)
- laterality (text)
- approach (text)
- duration_minutes (integer)
- estimated_blood_loss_ml (integer)
- specimens_removed (text)
- drains_placed (text)
- post_op_diagnosis (text)
- discharge_instructions (text)
- follow_up_required (boolean)
- follow_up_date (date)
- consolidation_reasoning (text)
- merged_ids (ARRAY)
- visit_history (jsonb)
- surgeon_name (text)
- facility_name (text)
- cpt_code (text)
- icd10_procedure_code (text)
- anatomical_site (text)
- urgency_level (text)
- length_of_stay (integer)
- blood_loss (text)
- transfusions_required (boolean)
- implants_hardware (text)
- recovery_status (text)
- last_updated_encounter (integer)

#### Table: template_shares
- template_id (integer)
- shared_by (integer)
- shared_with (integer)
- status (text)
- shared_at (timestamp without time zone)
- responded_at (timestamp without time zone)
- share_message (text)
- can_modify (boolean)
- active (boolean)

#### Table: template_versions
- template_id (integer)
- version_number (integer)
- change_description (text)
- changed_by (integer)
- example_note_snapshot (text)
- generated_prompt_snapshot (text)
- change_type (text)

#### Table: user_assistant_threads
- user_id (integer)
- assistant_type (text)
- thread_id (text)
- assistant_id (text)
- context (jsonb)
- last_message_at (timestamp without time zone)
- message_count (integer)
- active (boolean)

#### Table: user_edit_patterns
- user_id (integer)
- note_type (text)
- section_name (text)
- edit_type (text)
- original_text (text)
- edited_text (text)
- edit_frequency (integer)
- confidence_score (numeric)
- last_occurrence (timestamp without time zone)

#### Table: user_locations
- user_id (integer)
- location_id (integer)
- is_primary (boolean)
- permissions (jsonb)
- role_at_location (text)

#### Table: user_note_preferences
- user_id (integer)
- last_selected_note_type (character varying)
- default_chief_complaint (text)
- default_physical_exam (text)
- default_ros_negatives (text)
- default_assessment_style (character varying)
- use_voice_commands (boolean)
- auto_save_interval (integer)
- show_template_suggestions (boolean)
- include_time_stamps (boolean)
- default_note_font_size (integer)
- default_macro_set (character varying)
- preferred_exam_order (ARRAY)
- custom_normal_exams (jsonb)
- abbreviation_expansions (jsonb)
- quick_phrases (jsonb)
- billing_reminder_enabled (boolean)
- sign_reminder_minutes (integer)
- default_soap_template (integer)
- default_apso_template (integer)
- default_progress_template (integer)
- default_h_and_p_template (integer)
- default_discharge_template (integer)
- default_procedure_template (integer)
- global_ai_learning (boolean)
- learning_aggressiveness (text)
- remember_last_template (boolean)
- show_template_preview (boolean)
- auto_save_changes (boolean)
- medical_problems_display_threshold (integer)
- ranking_weights (jsonb)
- chart_panel_width (integer)
- enable_dense_view (boolean)

#### Table: user_note_templates
- user_id (integer)
- template_name (text)
- base_note_type (text)
- display_name (text)
- is_personal (boolean)
- is_default (boolean)
- created_by (integer)
- shared_by (integer)
- example_note (text)
- base_note_text (text)
- inline_comments (jsonb)
- has_comments (boolean)
- generated_prompt (text)
- prompt_version (integer)
- enable_ai_learning (boolean)
- learning_confidence (numeric)
- last_learning_update (timestamp without time zone)
- usage_count (integer)
- last_used (timestamp without time zone)
- version (integer)
- parent_template_id (integer)
- active (boolean)

#### Table: user_problem_list_preferences
- user_id (integer)
- show_resolved_problems (boolean)
- show_inactive_problems (boolean)
- sort_by (text)
- group_by_category (boolean)
- highlight_recent_changes (boolean)
- recent_change_days (integer)
- max_problems_displayed (integer)

#### Table: user_session_locations
- user_id (integer)
- location_id (integer)
- session_id (character varying)
- is_primary (boolean)
- permissions (jsonb)
- remembered (boolean)
- is_active (boolean)
- remember_selection (boolean)
- selected_at (timestamp without time zone)

#### Table: users
- username (character varying)
  ⚠️  HAS DATA: 5 non-null values
- email (character varying)
  ⚠️  HAS DATA: 5 non-null values
- password (character varying)
  ⚠️  HAS DATA: 5 non-null values
- first_name (character varying)
  ⚠️  HAS DATA: 5 non-null values
- last_name (character varying)
  ⚠️  HAS DATA: 5 non-null values
- role (character varying)
  ⚠️  HAS DATA: 5 non-null values
- npi (character varying)
  ⚠️  HAS DATA: 1 non-null values
- credentials (character varying)
  ⚠️  HAS DATA: 5 non-null values
- specialties (ARRAY)
  ⚠️  HAS DATA: 1 non-null values
- license_number (character varying)
  ⚠️  HAS DATA: 1 non-null values
- license_state (character varying)
- bio (text)
- is_active (boolean)
  ⚠️  HAS DATA: 5 non-null values
- last_login (timestamp without time zone)
  ⚠️  HAS DATA: 2 non-null values
- profile_image_url (character varying)
- health_system_id (integer)
  ⚠️  HAS DATA: 5 non-null values
- email_verified (boolean)
  ⚠️  HAS DATA: 5 non-null values
- email_verification_token (text)
  ⚠️  HAS DATA: 3 non-null values
- email_verification_expires (timestamp without time zone)
  ⚠️  HAS DATA: 3 non-null values
- mfa_enabled (boolean)
  ⚠️  HAS DATA: 5 non-null values
- mfa_secret (text)
- account_status (text)
  ⚠️  HAS DATA: 5 non-null values
- failed_login_attempts (integer)
  ⚠️  HAS DATA: 5 non-null values
- account_locked_until (timestamp without time zone)
- require_password_change (boolean)
  ⚠️  HAS DATA: 5 non-null values
- verification_status (text)
  ⚠️  HAS DATA: 5 non-null values
- verified_with_key_id (integer)
- verified_at (timestamp without time zone)
- active (boolean)
  ⚠️  HAS DATA: 5 non-null values

#### Table: vitals
- patient_id (integer)
- encounter_id (integer)
- blood_pressure_systolic (integer)
- blood_pressure_diastolic (integer)
- heart_rate (integer)
- respiratory_rate (integer)
- temperature (numeric)
- oxygen_saturation (integer)
- weight (numeric)
- height (numeric)
- bmi (numeric)
- recorded_at (timestamp without time zone)
- recorded_by (integer)
- notes (text)
- pain_scale (integer)
- blood_glucose (integer)
- source_type (text)
- source_confidence (numeric)
- extracted_from_attachment_id (integer)
- extraction_notes (text)
- consolidation_reasoning (text)
- merged_ids (ARRAY)
- visit_history (jsonb)
- entry_type (text)
- systolic (integer)
- diastolic (integer)
- systolic_bp (integer)
- diastolic_bp (integer)
- alerts (jsonb)
- parsed_from_text (boolean)
- processing_notes (text)
- original_text (text)
- source_notes (text)
- entered_by (integer)

#### Table: webauthn_credentials
- user_id (integer)
- credential_id (text)
- public_key (text)
- counter (bigint)
- device_type (text)
- transports (ARRAY)
- last_used_at (timestamp without time zone)
- registered_device (text)
- device_name (text)

### 4. Missing Columns (in schema but not DB - need to be added):
None


## RECOMMENDED SAFE MIGRATION APPROACH

1. **DO NOT DELETE ANY COLUMNS WITH DATA**
2. First, add all orphaned columns back to schema.ts
3. Then run db:push to add missing columns
4. Test the application thoroughly
5. Only remove truly unused columns after verification
